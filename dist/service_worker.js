(()=>{const e=e=>{chrome.action.setPopup({tabId:e,popup:"../src/Popup/popup.html"}),chrome.action.setIcon({tabId:e,path:"images/online-video_128_enabled.png"})},s=async(s={id:Number},a={payload:Number},o="changePlaybackSpeed")=>("changePlaybackSpeed"===o?(console.log("message from slider.js / background.js"),console.log({currentTab:s,request:a,message:o})):"getPlayBackSpeedOnPageLoad"===o&&(console.log("message from on page load...."),console.log({currentTab:s,request:a,message:o})),chrome.tabs.sendMessage(s.id,{message:o,payload:a.payload},(a=>{const{lastError:t=""}=chrome.runtime;t?console.log(t):"success"===a?.message&&"getPlayBackSpeedOnPageLoad"===o&&(console.log("enabled!"),console.log({response:a,message:o}),e(s.id))}))),a=new RegExp("netflix","g");chrome.tabs.onUpdated.addListener((async(o,t,l)=>{l.active&&"complete"===t.status&&/^http/.test(l.url)&&(console.log(o,t,l),a.test(l.url)&&(e(l.id),chrome.scripting.executeScript({target:{tabId:l.id},files:["./dist/netflix_subtitles.js"]},(()=>{chrome.storage.local.get("subtitlesOptions",(e=>{e&&chrome.tabs.sendMessage(o,{message:"update_netflix_subtitles_styles",payload:e.subtitlesOptions},(e=>{"netflix subtitles styles enabled"===e?.message&&console.log({subTitlesMsg:e.message})}))}))}))),chrome.storage.local.get("playbackspeed",(e=>{e&&s(l,{payload:e.playbackspeed},"getPlayBackSpeedOnPageLoad")})))}));const o=(e={payload:Number},s="")=>{chrome.storage.local.set({[s]:e.payload})};chrome.runtime.onInstalled.addListener((async()=>{o({payload:1},"playbackspeed")})),chrome.runtime.onMessage.addListener(((e,a,t)=>"foundVideo"===e.message?(chrome.storage.local.get("playbackspeed",(e=>{chrome.runtime.lastError?t({message:"fail"}):t({message:"foundVideoSuccess",payload:e.playbackspeed})})),!0):"updatePlaybackSpeed"===e.message?(t({message:"success",payload:"got your message slider"}),o(e,"playbackspeed"),(async e=>{const a=await(async()=>{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e})();s(a,e)})(e),!0):"getPlayBackSpeedFromStorage"!==e.message||(chrome.storage.local.get("playbackspeed",(e=>{chrome.runtime.lastError?t({message:"fail"}):t({message:"success",payload:e.playbackspeed})})),!0)))})();